# imgElo 项目开发策划书

## 1. 项目概述 (Project Overview)
**imgElo** 是一个轻量级、本地化的图像美学评分训练系统。它摒弃了传统的“打分制”系统，采用 **Elo 等级分系统 (Elo Rating System)** 结合 **1v1 双盲对决** 的方式，通过人类的主观偏好选择，自动计算并量化图片的美学分数。

该项目的核心目标是解决个人审美数据集构建中的效率低、标准不统一（审美漂移）问题，利用**主动学习 (Active Learning)** 策略，优先展示分数不稳定的图片，从而快速训练出高质量的个性化审美模型。

## 2. 核心价值与痛点解决
* **解决审美漂移**：相比 1-10 分打分制，两图对比（Pairwise Comparison）大大降低了认知负荷，消除了因心情波动导致的评分标准不一致。
* **高效收敛**：引入“分数导数”（稳定性）概念，系统自动识别并“冷藏”已定型的图片，集中算力（人力）攻克争议图片。
* **数据纯净**：通过多次对决产生的相对排名，比绝对打分具有更高的颗粒度和可信度。

## 3. 技术架构 (Technical Architecture)
本项目采用 **全 Python** 栈开发，确保低维护成本与高扩展性。

* **前端 (Frontend)**: `Gradio`
    * 利用其 Block API 构建响应式布局。
    * 原生支持键盘快捷键 (`←` / `→`)，实现极速流操作。
* **后端 (Backend)**: `Python` (Native)
    * 纯 Python 编写的 Elo 结算引擎与调度器。
* **数据库 (Database)**: `SQLite`
    * 单文件存储，零配置。
    * 维护两张核心表：`images` (图池与分数) 和 `matches` (对战流水)。

## 4. 功能模块设计

### 4.1 竞技场 (The Arena) - 核心模块
* **1v1 对决模式**：
    * 每次随机抽取两张图片（基于调度算法）。
    * 用户选择胜者后，**两张图片均刷新**（不采用赢家守擂，保证样本多样性）。
* **交互逻辑**：
    * 支持鼠标点击与键盘左右键。
    * 支持撤销（Undo）：允许回滚最近N步操作（默认 N=1000）。
* **实时反馈**：
    * 显示当前比分变化。
    * (可选) 显示当前图片的“不确定度”状态。

### 4.2 核心算法引擎 (Elo Engine)
* **基础 Elo 公式**：计算胜率期望与分数变动。
* **动态 K 值系统 (Active Learning)**：
    * **定级赛保护**：对场次 < 10 的图片，K 值加倍，使其快速定位。
    * **波动率加权**：监控图片分数的“导数”（近期波动幅度）。波动大则 K 值大，波动趋零则 K 值减小并降低出现频率。

### 4.3 数据管理 (Data Manager)
* **海选模式 (Audition - 规划中)**：
    * 九宫格视图，快速剔除明显崩坏的图片（标记为 Trash）。
* **自动入库**：
    * 脚本启动时扫描指定文件夹，自动增量添加新图到 SQLite。

## 5. 项目结构 (Project Structure)
```text
imgElo/
├── data/
│   └── elo.db             # SQLite 数据库
├── src/
│   ├── __init__.py
│   ├── db.py              # 数据库 CRUD 操作
│   ├── logic.py           # Elo 算法与匹配调度器
│   └── ui.py              # Gradio 界面布局
├── config.py              # 配置文件 (路径、K值、历史限制)
├── main.py                # 启动入口
├── requirements.txt
└── README.md
````

## 6\. 开发路线图 (Roadmap)

  * **Phase 1 (MVP)**: 完成数据库建表、基础 Elo 算法、1v1 界面、键盘支持、撤销功能。
  * **Phase 2 (Optimization)**: 实现基于波动率的调度算法（优先推送不稳定图片）。
  * **Phase 3 (Expansion)**: 添加“海选模式”九宫格界面；导出高分图片路径用于训练。

<!-- end list -->
